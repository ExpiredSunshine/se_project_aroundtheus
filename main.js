!function(){"use strict";class e{constructor(e,t,s,i,r){let{name:n,link:a,_id:o,isLiked:l}=e;this._name=n,this._link=a,this._id=o,this.isLiked=l,this._cardTemplate=t,this._handleImageClick=s,this._handleTrashClick=i,this._api=r,this.element=this._getTemplate(),this.likeButton=this.element.querySelector(".card__like-button"),this._deleteButton=this.element.querySelector(".card__delete-button"),this._cardImage=this.element.querySelector(".card__image"),this._cardTitle=this.element.querySelector(".card__title"),this._setEventListeners()}_getTemplate(){return this._cardTemplate.content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this.likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleTrashClick(this)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_handleLikeClick(){this.isLiked?this._api.unlikeCard(this._id).then((()=>{this.isLiked=!1,this._updateLikeButton()})).catch((e=>console.error("Error unliking card:",e))):this._api.likeCard(this._id).then((()=>{this.isLiked=!0,this._updateLikeButton()})).catch((e=>console.error("Error liking card:",e)))}_updateLikeButton(){this.likeButton.classList.toggle("card__like-button_active",this.isLiked)}setLikedState(e){this.isLiked=e,this._updateLikeButton()}getView(){return this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this.isLiked&&this.likeButton.classList.add("card__like-button_active"),this.element}}class t{constructor(e,t){this._settings=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._formElement.querySelector(this._settings.submitButton)}_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._settings.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._settings.inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setEventListeners(){this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this.toggleButtonState()}}class s{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}class i extends s{constructor(e,t){let{handleFormSubmit:s}=t;super(e),this._handleFormSubmit=s,this._form=this._popup.querySelector(".modal__form"),this._inputList=this._form.querySelectorAll(".modal__input"),this._submitButton=this._form.querySelector(".modal__button")}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}_setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}toggleUploadIndicator(e){e?(this._submitButton.textContent="Saving...",this._submitButton.disabled=!0):(this._submitButton.textContent="Save",this._submitButton.disabled=!1)}getForm(){return this._form}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const r=document.querySelector("#profile__edit-button"),n=document.querySelector("#profile-name-input"),a=document.querySelector("#image-URL-input"),o=document.querySelector("#profile-description-input"),l=document.querySelector(".profile__image-container"),d=document.querySelector(".profile__add-button"),h=document.querySelector("#card-template"),c=new class extends s{constructor(e){super(e),this._popupImage=this._popup.querySelector(".modal__image"),this._popupImageTitle=this._popup.querySelector(".modal__image-title")}open(e){let{name:t,link:s}=e;this._popupImage.src=s,this._popupImage.alt=t,this._popupImageTitle.textContent=t,super.open()}}("#image-modal");c.setEventListeners();const u=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getCardList(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}addCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}getProfileData(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}editProfileData(e){let{name:t,about:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}editUserAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"b656ee04-ff76-4b23-b20a-1e4991fc7f99","Content-Type":"application/json"}}),_=new class{constructor(e){let{nameSelector:t,aboutSelector:s,avatarSelector:i}=e;this._profileName=document.querySelector(t),this._profileAbout=document.querySelector(s),this._profileAvatar=document.querySelector(i)}getUserInfo(){return{name:this._profileName.textContent,about:this._profileAbout.textContent,avatar:this._profileAvatar.src}}setUserInfo(e){let{name:t,about:s,avatar:i}=e;void 0!==t&&(this._profileName.textContent=t),void 0!==s&&(this._profileAbout.textContent=s),void 0!==i&&(this._profileAvatar.src=i)}}({nameSelector:".profile__name",aboutSelector:".profile__description",avatarSelector:".profile__image"});function m(t){const s=new e(t,h,(e=>c.open(e)),E,u);return s.setLikedState(t.isLiked),s}u.getProfileData().then((e=>{_.setUserInfo({name:e.name,about:e.about,avatar:e.avatar})})).catch((e=>{console.error("Failed to fetch profile data:",e)}));const p=new i("#profile-edit-modal",{handleFormSubmit:e=>{p.toggleUploadIndicator(!0),u.editProfileData(e).then((e=>{_.setUserInfo(e),p.getForm().reset(),p.close()})).catch((e=>{console.log("Error updating Profile:",e)})).finally((()=>{p.toggleUploadIndicator(!1)}))}});p.setEventListeners();const f=new i("#avatar-edit-modal",{handleFormSubmit:e=>{const t=e["Image URL"];f.toggleUploadIndicator(!0),u.editUserAvatar({avatar:t}).then((e=>{_.setUserInfo({avatar:e.avatar}),f.getForm().reset(),f.close()})).catch((e=>{console.log("Error updating Avatar:",e)})).finally((()=>{f.toggleUploadIndicator(!1)}))}});f.setEventListeners();const g=new class{constructor(e,t){let{items:s=[],renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>this._renderer(e)))}appendItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}({items:[],renderer:e=>{const t=m(e);g.appendItem(t.getView())}},".cards__list");u.getCardList().then((e=>{g.renderItems(e)})).catch((e=>{console.error("Failed to fetch or render cards:",e)}));const v=new i("#add-card-modal",{handleFormSubmit:e=>{const t={name:e.title,link:e["Image URL"]};v.toggleUploadIndicator(!0),u.addCard(t).then((e=>{const t=m(e).getView();g.prependItem(t),L["add-card-form"].resetValidation(),v.getForm().reset(),v.close()})).catch((e=>console.error("Error adding card:",e))).finally((()=>v.toggleUploadIndicator(!1)))}});v.setEventListeners();const b=new class extends s{constructor(e,t){super(e),this._form=this._popup.querySelector(".modal__form"),this._handleFormSubmit=t}setSubmitHandler(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}("#delete-card-modal",(()=>{}));function E(e){b.open(),b.setSubmitHandler((()=>{u.deleteCard(e._id).then((()=>{e.element.remove(),e.element=null,b.close()})).catch((e=>console.error("Failed to delete card:",e)))}))}b.setEventListeners();const L={};var k;k={formSelector:".form-selector",inputSelector:".modal__input",submitButton:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(k.formSelector)).forEach((e=>{const s=new t(k,e),i=e.getAttribute("name");L[i]=s,s.enableValidation()})),r.addEventListener("click",(()=>{const{name:e,about:t}=_.getUserInfo();n.value=e,o.value=t,L["profile-form"].resetValidation(),p.open()})),l.addEventListener("click",(()=>{const{avatar:e}=_.getUserInfo();a.value=e,L["avatar-form"].resetValidation(),f.open()})),d.addEventListener("click",(()=>{L["add-card-form"].resetValidation(),v.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQWtCakYsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTSxLQUFFckIsRUFBSSxNQUFFdUksR0FBVUssRUFBU08sY0FDakM1QyxFQUFpQlAsTUFBUWhHLEVBQ3pCeUcsRUFBa0JULE1BQVF1QyxFQUMxQnlDLEVBQWUsZ0JBQWdCeEcsa0JBQy9CaUYsRUFBaUIxRSxNQUFNLElBR3pCMkIsRUFBaUJyRixpQkFBaUIsU0FBUyxLQUN6QyxNQUFNLE9BQUVxSCxHQUFXRSxFQUFTTyxjQUM1QjNDLEVBQWVSLE1BQVEwQyxFQUN2QnNDLEVBQWUsZUFBZXhHLGtCQUM5QnNGLEVBQWdCL0UsTUFBTSxJQUd4QjRCLEVBQWN0RixpQkFBaUIsU0FBUyxLQUN0QzJKLEVBQWUsaUJBQWlCeEcsa0JBQ2hDc0csRUFBYS9GLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvQVBJLmpzIiwid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHsgbmFtZSwgbGluaywgX2lkLCBpc0xpa2VkIH0sXHJcbiAgICBjYXJkVGVtcGxhdGUsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlVHJhc2hDbGljayxcclxuICAgIGFwaVxyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX2lkID0gX2lkO1xyXG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IGNhcmRUZW1wbGF0ZTtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayA9IGhhbmRsZVRyYXNoQ2xpY2s7XHJcbiAgICB0aGlzLl9hcGkgPSBhcGk7XHJcbiAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5saWtlQnV0dG9uID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMubGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VDbGljaygpIHtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fYXBpXHJcbiAgICAgICAgLnVubGlrZUNhcmQodGhpcy5faWQpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5pc0xpa2VkID0gZmFsc2U7XHJcbiAgICAgICAgICB0aGlzLl91cGRhdGVMaWtlQnV0dG9uKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgdW5saWtpbmcgY2FyZDpcIiwgZXJyb3IpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2FwaVxyXG4gICAgICAgIC5saWtlQ2FyZCh0aGlzLl9pZClcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmlzTGlrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgdGhpcy5fdXBkYXRlTGlrZUJ1dHRvbigpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGxpa2luZyBjYXJkOlwiLCBlcnJvcikpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3VwZGF0ZUxpa2VCdXR0b24oKSB7XHJcbiAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiLCB0aGlzLmlzTGlrZWQpO1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZWRTdGF0ZShpc0xpa2VkKSB7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZUJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xyXG4gICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uXG4gICAgKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldmVudCkge1xuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgeyBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgX3NldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZVVwbG9hZEluZGljYXRvcihpc1VwbG9hZGluZykge1xyXG4gICAgaWYgKGlzVXBsb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRGb3JtKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm07XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBJbXBvcnRzXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuaW1wb3J0IHsgdmFsaWRhdGlvblNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFQSSBmcm9tIFwiLi4vY29tcG9uZW50cy9BUEkuanNcIjtcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gU2VsZWN0b3JzXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGF2YXRhclVSTElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1VUkwtaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVBYm91dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCIpO1xyXG5jb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1jb250YWluZXJcIik7XHJcbmNvbnN0IGNhcmRBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gSW1hZ2UgUG9wdXAgSW5zdGFuY2VcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLW1vZGFsXCIpO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEFQSSBJbnN0YW5jZVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IGFwaSA9IG5ldyBBUEkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImI2NTZlZTA0LWZmNzYtNGIyMy1iMjBhLTFlNDk5MWZjN2Y5OVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFVzZXJJbmZvIEluc3RhbmNlXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIGFib3V0U2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDcmVhdGUgQ2FyZCBmdW5jdGlvblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBjYXJkRGF0YSxcclxuICAgIGNhcmRUZW1wbGF0ZSxcclxuICAgIChkYXRhKSA9PiBpbWFnZVBvcHVwLm9wZW4oZGF0YSksXHJcbiAgICBoYW5kbGVUcmFzaENsaWNrLFxyXG4gICAgYXBpXHJcbiAgKTtcclxuICBjYXJkLnNldExpa2VkU3RhdGUoY2FyZERhdGEuaXNMaWtlZCk7XHJcbiAgcmV0dXJuIGNhcmQ7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gSW5pdGFsIFVzZXJJbmZvIFBvcHVsYXRpb25cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5hcGlcclxuICAuZ2V0UHJvZmlsZURhdGEoKVxyXG4gIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXIsXHJcbiAgICB9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggcHJvZmlsZSBkYXRhOlwiLCBlcnJvcik7XHJcbiAgfSk7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEVkaXRpbmcgVXNlckluZm8gUG9wdXBcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsIHtcclxuICBoYW5kbGVGb3JtU3VibWl0OiAoZm9ybURhdGEpID0+IHtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXAudG9nZ2xlVXBsb2FkSW5kaWNhdG9yKHRydWUpO1xyXG5cclxuICAgIGFwaVxyXG4gICAgICAuZWRpdFByb2ZpbGVEYXRhKGZvcm1EYXRhKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgICAgIHByb2ZpbGVFZGl0UG9wdXAuZ2V0Rm9ybSgpLnJlc2V0KCk7XHJcbiAgICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciB1cGRhdGluZyBQcm9maWxlOlwiLCBlcnJvcik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBwcm9maWxlRWRpdFBvcHVwLnRvZ2dsZVVwbG9hZEluZGljYXRvcihmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxucHJvZmlsZUVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBFZGl0aW5nIFVzZXJBdmF0YXIgUG9wdXBcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBhdmF0YXJFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmF0YXItZWRpdC1tb2RhbFwiLCB7XHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGZvcm1EYXRhKSA9PiB7XHJcbiAgICBjb25zdCBhdmF0YXJVUkwgPSBmb3JtRGF0YVtcIkltYWdlIFVSTFwiXTtcclxuICAgIGF2YXRhckVkaXRQb3B1cC50b2dnbGVVcGxvYWRJbmRpY2F0b3IodHJ1ZSk7XHJcblxyXG4gICAgYXBpXHJcbiAgICAgIC5lZGl0VXNlckF2YXRhcih7IGF2YXRhcjogYXZhdGFyVVJMIH0pXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhcixcclxuICAgICAgICB9KTtcclxuICAgICAgICBhdmF0YXJFZGl0UG9wdXAuZ2V0Rm9ybSgpLnJlc2V0KCk7XHJcbiAgICAgICAgYXZhdGFyRWRpdFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIHVwZGF0aW5nIEF2YXRhcjpcIiwgZXJyb3IpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgYXZhdGFyRWRpdFBvcHVwLnRvZ2dsZVVwbG9hZEluZGljYXRvcihmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxuYXZhdGFyRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIENhcmQgU2VjdGlvbiBJbnN0YW5jZVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgaXRlbXM6IFtdLFxyXG4gICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFwcGVuZEl0ZW0oY2FyZC5nZXRWaWV3KCkpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmNhcmRzX19saXN0XCJcclxuKTtcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gSW5pdGlhbCBDYXJkIENyZWF0aW9uICYgUmVuZGVyaW5nIGZyb20gQVBJXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuYXBpXHJcbiAgLmdldENhcmRMaXN0KClcclxuICAudGhlbigoY2FyZExpc3QpID0+IHtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRMaXN0KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggb3IgcmVuZGVyIGNhcmRzOlwiLCBlcnJvcik7XHJcbiAgfSk7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEFkZGl0aW9uYWwgQ2FyZCBhZGRpbmcgdG8gQVBJICYgRE9NXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmQtbW9kYWxcIiwge1xyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChmb3JtRGF0YSkgPT4ge1xyXG4gICAgY29uc3QgY2FyZERhdGEgPSB7XHJcbiAgICAgIG5hbWU6IGZvcm1EYXRhW1widGl0bGVcIl0sXHJcbiAgICAgIGxpbms6IGZvcm1EYXRhW1wiSW1hZ2UgVVJMXCJdLFxyXG4gICAgfTtcclxuXHJcbiAgICBhZGRDYXJkUG9wdXAudG9nZ2xlVXBsb2FkSW5kaWNhdG9yKHRydWUpO1xyXG5cclxuICAgIGFwaVxyXG4gICAgICAuYWRkQ2FyZChjYXJkRGF0YSlcclxuICAgICAgLnRoZW4oKGFwaUNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoYXBpQ2FyZERhdGEpLmdldFZpZXcoKTtcclxuICAgICAgICBjYXJkU2VjdGlvbi5wcmVwZW5kSXRlbShjYXJkKTtcclxuICAgICAgICBjb25zdCB2YWxpZGF0b3IgPSBmb3JtVmFsaWRhdG9yc1tcImFkZC1jYXJkLWZvcm1cIl07XHJcbiAgICAgICAgdmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgICAgIGFkZENhcmRQb3B1cC5nZXRGb3JtKCkucmVzZXQoKTtcclxuICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBjYXJkOlwiLCBlcnJvcikpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IGFkZENhcmRQb3B1cC50b2dnbGVVcGxvYWRJbmRpY2F0b3IoZmFsc2UpKTtcclxuICB9LFxyXG59KTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDYXJkIGRlbGV0aW9uIGZyb20gQVBJICYgRE9NXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aENvbmZpcm0oXCIjZGVsZXRlLWNhcmQtbW9kYWxcIiwgKCkgPT4ge30pO1xyXG5kZWxldGVDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVRyYXNoQ2xpY2soY2FyZCkge1xyXG4gIGRlbGV0ZUNhcmRNb2RhbC5vcGVuKCk7XHJcbiAgZGVsZXRlQ2FyZE1vZGFsLnNldFN1Ym1pdEhhbmRsZXIoKCkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuX2lkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIGNhcmQuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZGVsZXRlIGNhcmQ6XCIsIGVycm9yKSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gVmFsaWRhdGlvblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25TZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvblNldHRpbmdzLmZvcm1TZWxlY3RvcilcclxuICApO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvblNldHRpbmdzKTtcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gRXZlbnQgTGlzdGVuZXJzXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xyXG4gIHByb2ZpbGVBYm91dElucHV0LnZhbHVlID0gYWJvdXQ7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgcHJvZmlsZUVkaXRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHsgYXZhdGFyIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGF2YXRhclVSTElucHV0LnZhbHVlID0gYXZhdGFyO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiYXZhdGFyLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyRWRpdFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5jYXJkQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJhZGQtY2FyZC1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZVRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtdGl0bGVcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBUEkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICB9XHJcblxyXG4gIGdldENhcmRMaXN0KCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRQcm9maWxlRGF0YSgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZURhdGEoeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGFib3V0U2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcHJvZmlsZUFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl9wcm9maWxlQWJvdXQudGV4dENvbnRlbnQsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fcHJvZmlsZUF2YXRhci5zcmMsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCwgYXZhdGFyIH0pIHtcclxuICAgIGlmIChuYW1lICE9PSB1bmRlZmluZWQpIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIGlmIChhYm91dCAhPT0gdW5kZWZpbmVkKSB0aGlzLl9wcm9maWxlQWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgIGlmIChhdmF0YXIgIT09IHVuZGVmaW5lZCkgdGhpcy5fcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMgPSBbXSwgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxuXHJcbiAgYXBwZW5kSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcHJlcGVuZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgfVxyXG5cclxuICBzZXRTdWJtaXRIYW5kbGVyKGhhbmRsZXIpIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVyO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWxpZGF0aW9uXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm0tc2VsZWN0b3JcIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b246IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFRlbXBsYXRlIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZVRyYXNoQ2xpY2siLCJhcGkiLCJuYW1lIiwibGluayIsIl9pZCIsImlzTGlrZWQiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkVGVtcGxhdGUiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVUcmFzaENsaWNrIiwiX2FwaSIsImVsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJsaWtlQnV0dG9uIiwicXVlcnlTZWxlY3RvciIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlIiwiX2NhcmRUaXRsZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VDbGljayIsInVubGlrZUNhcmQiLCJ0aGVuIiwiX3VwZGF0ZUxpa2VCdXR0b24iLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxpa2VDYXJkIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwic2V0TGlrZWRTdGF0ZSIsImdldFZpZXciLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsImFkZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwic29tZSIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJkb2N1bWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiZXZlbnQiLCJrZXkiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm0iLCJfc3VibWl0QnV0dG9uIiwiX2dldElucHV0VmFsdWVzIiwiX2Zvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwiX3NldElucHV0VmFsdWVzIiwiZGF0YSIsInRvZ2dsZVVwbG9hZEluZGljYXRvciIsImlzVXBsb2FkaW5nIiwiZ2V0Rm9ybSIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZU5hbWVJbnB1dCIsImF2YXRhclVSTElucHV0IiwicHJvZmlsZUFib3V0SW5wdXQiLCJhdmF0YXJFZGl0QnV0dG9uIiwiY2FyZEFkZEJ1dHRvbiIsImltYWdlUG9wdXAiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cEltYWdlVGl0bGUiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRDYXJkTGlzdCIsImZldGNoIiwiYWRkQ2FyZCIsIl9yZWYyIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiZ2V0UHJvZmlsZURhdGEiLCJlZGl0UHJvZmlsZURhdGEiLCJfcmVmMyIsImFib3V0IiwiZWRpdFVzZXJBdmF0YXIiLCJfcmVmNCIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImFib3V0U2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlQWJvdXQiLCJfcHJvZmlsZUF2YXRhciIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJ1bmRlZmluZWQiLCJjcmVhdGVDYXJkIiwiY2FyZERhdGEiLCJjYXJkIiwicHJvZmlsZUVkaXRQb3B1cCIsImZvcm1EYXRhIiwicmVzZXQiLCJsb2ciLCJmaW5hbGx5IiwiYXZhdGFyRWRpdFBvcHVwIiwiYXZhdGFyVVJMIiwiY2FyZFNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYXBwZW5kSXRlbSIsImFwcGVuZCIsInByZXBlbmRJdGVtIiwicHJlcGVuZCIsImNhcmRMaXN0IiwiYWRkQ2FyZFBvcHVwIiwiYXBpQ2FyZERhdGEiLCJmb3JtVmFsaWRhdG9ycyIsImRlbGV0ZUNhcmRNb2RhbCIsInNldFN1Ym1pdEhhbmRsZXIiLCJoYW5kbGVyIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9